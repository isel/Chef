require 'yaml'
# Helpers.update_properties
# cannot be used because it is not generic enough
  token_values = <%= @token_values %>
  source_file = '<%= @source_file %>'
  target_file  = '<%= @target_file %>'
$stderr.puts "Token_values: " + token_values.to_yaml
File.open(source_file, 'r+') { |f| contents = f.read }
begin

token_values.each do |token, value|
  token_match = token  + '\s*=.*$'
  result = token + ' = ' + value.gsub(/\/,'\\\\')
  matcher = Regexp.new('(' + token_match + ')')
  if matcher.match(contents)
    contents = contents.gsub(matcher, result)
    else
    contents = contents + "\n" + result
  end

end
rescue=>e
end
File.open(target_file, 'w') { |f| f.puts contents }
